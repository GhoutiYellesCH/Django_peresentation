{% extends 'base.html' %}
{% block content %}
  <div class="row">
    <div class="col-md-7">
      <h1 class="display-5 fw-bold text-success">Phase 2: L'ORM (Parler Python à la DB)</h1>
      <p class="lead">L'ORM (Object-Relational Mapping) est le composant "magique" de Django : il permet d'interagir avec la base de données (le Frigo) en utilisant uniquement des objets Python au lieu du langage SQL brut.</p>
      <h3 class="mt-4 text-warning">Avantage Clé : Plus de SQL !</h3>
      <p>Pour créer une table ou récupérer des données, vous écrivez des classes Python, et Django génère le SQL pour vous en toute sécurité. Ceci évite les erreurs et les injections SQL.</p>
      
      <h3 class="mt-4">Live Demo: Requêtes ORM</h3>
      <p>La page des articles récupère toutes les données créées via l'Admin (Phase 5) en une seule ligne de code Python très lisible.</p>
      <a href="{% url 'article_list' %}" class="btn btn-primary btn-lg mt-2">Voir la Liste des Articles (Live Data)</a>
    </div>
    
    <div class="col-md-5">
      <h3 class="mt-4">1. Définir le Modèle (La Table)</h3>
      {% verbatim %}
      <pre><code class="language-python">
# presentation/models.py : Définition de la table 'Article'
from django.db import models

class Article(models.Model):
    title = models.CharField(max_length=200) # (VARCHAR)
    content = models.TextField()             # (TEXT)
    date_pub = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return self.title
      </code></pre>
      {% endverbatim %}
      <h3 class="mt-4">2. Utiliser l'ORM (La Requête)</h3>
      <p class="text-muted">Ceci remplace <code>SELECT * FROM article ORDER BY date_pub DESC;</code></p>
      {% verbatim %}
      <pre><code class="language-python">
# Récupérer TOUS les articles triés par date
articles = Article.objects.all().order_by('-date_pub') 

# Créer un nouvel article
Article.objects.create(title="Titre", content="Contenu")
      </code></pre>
      {% endverbatim %}
    </div>
  </div>
  <hr>
  <div class="d-grid gap-2 d-md-flex justify-content-md-end">
    <a href="{% url 'templates_demo' %}" class="btn btn-success btn-lg">Phase 3 Suivante: Le Plat (Templates) →</a>
  </div>
{% endblock %}